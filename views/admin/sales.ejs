<%- include('../partials/admin-header.ejs') %>

    <section class="content-main">

        <% if (orders.length === 0) { %>
            <p>No orders found.</p>
        <% } else { %>
            <div class="content-header ">
                <div>
                    <h2 class="content-title card-title">Sales Report</h2>
                </div>
                
            </div>


            <!-- Add date input fields for filtering -->
            <div class="container pt-3">
                <form method="get" action="/admin/sales" class="form-inline">
                    <div class="form-group mr-2 mb-30">
                        <label for="startDate" class="mr-2">Start Date:</label>
                        <input type="date" id="startDate" name="startDate" class="form-control">
                    </div>
            
                    <div class="form-group mr-2 mb-30">
                        <label for="endDate" class="mr-2">End Date:</label>
                        <input type="date" id="endDate" name="endDate" class="form-control">
                    </div>
            
                    <button class="btn btn-primary" type="submit">Apply Filter</button>
                    <button class="btn btn-success ml-10" type="button" onclick="exportPDF()"><i class="fa-solid fa-download mr-5"></i>Export</button>

                </form>
            </div>
            
            <div class="container pt-5">
            
                <div class="table-responsive ">
                        <table id="example" class="table table-striped " style="width:100%">
                            <thead>
                                <tr>
                                    
                                    <th>Order ID</th>
                                    <th>Ordered Date</th>
                                    <th>User</th>
                                    <th>Total Price</th>
                                    <th> Payment</th>
                                    <th>Status</th>
                                    <th class="text-center">Delivery Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% for ( let order of orders ){ %>


                                    <tr>
                                        
                                        <td><%= order._id %></td>
                                        <td><%= order.orderedDate.toDateString() %></td>
                                        <td><%= order.userId.name %></td>
                                        <td>â‚¹<%= order.totalPrice %></td>
                                        <td ><%= order.paymentMethod %></td>
                                        <td id="order-status-<%= order._id %>"> <% if(order.orderStatus) { %> <%= order.orderStatus %> <% } else { %> Pending <% } %> </td>
                                        <td class="text-center"><%= order.deliveryStatus %></td>
                                        
                                    </tr>
                                <% } %>
                                
                            </tbody>
                            
                        </table>
                        <br><br>
                </div>

                <br><br><br>
            
            </div>

        <% } %>
        

    </section> <!-- content-main end// -->   

    <script>
        function exportPDF() {
            window.location.href = '/admin/sales?format=pdf';
        }
    </script>

<%- include('../partials/admin-footer.ejs') %>